<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Password Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap for clean styling -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUUlEQVQ4T63TT0gDURAF4C9jPq0VqBCrTEx3cRNEIwUCgQuCd0Fm5DbXEVhN3kkQTi6iKnM0i6JZ2IlZs3M7tzOyMAbN+nzG/vm/6OLx2AEpiUcc1cARv9wAqYL7pgi+GIrkgROqQhn5DUP7AJe6G0ZT3Sllnq7gyoU6MzwADnQj9I+O+XjHqTcz4xi+G8fA6LzP3kR3uFRhLKF5PCx8SeAEOb4VvQCm+JghnhhP9dR5HwxrQngEG0RMnwGhe8VBCGdGG9Yxk42nZ0StRHdFcv5CNHNgQpvA0h+R+H1hks3kFDE28S9v1e8EF3Cw0zi6g7qA4t+ivV1cQzW2HuCs+7+YdV6gAAAABJRU5ErkJggg==">

  <style>
    body {
      background: #f5f7fa;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      padding: 2rem;
    }
    .card {
      max-width: 650px;
      margin: 2rem auto;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .result-box {
      background: #212529;
      color: #f8f9fa;
      padding: 1rem;
      border-radius: 0.5rem;
      word-break: break-all;
      font-family: monospace;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="card p-4">
    <h2 class="text-center mb-4">Partner Password Generator</h2>

    <!-- Username + Case selection -->
    <div class="mb-3">
      <label for="username" class="form-label">Username</label>
      <div class="input-group">
        <input type="text" id="username" class="form-control" placeholder="Enter username">
        <select id="usernameCase" class="form-select" style="max-width: 160px;">
          <option value="asis" selected>As Entered</option>
          <option value="lower">Lowercase</option>
          <option value="upper">Uppercase</option>
        </select>
      </div>
    </div>

    <!-- Reference number -->
    <div class="mb-3">
      <label for="reference" class="form-label">Reference Number</label>
      <input type="text" id="reference" class="form-control" placeholder="e.g. 9238-6ED3-DF58-6EFE">
    </div>

    <button id="generateBtn" class="btn btn-primary w-100 mb-3">Generate Password</button>

    <!-- Results -->
    <div id="resultSection" class="d-none">
      <h6>Password (SHA-256):</h6>
      <div id="passwordResult" class="result-box"></div>
      <button id="copyBtn" class="btn btn-outline-light btn-sm mt-2">Copy to Clipboard</button>
    </div>
  </div>

  <!-- CryptoJS -->
  <script src="js/crypto-js.min.js"></script>
  <script>
    function normalizeReference(ref) {
      if (typeof ref !== 'string') return String(ref || '');
      // Replace various dash-like characters with ASCII '-'
      ref = ref.replace(/[\u2010-\u2015\u2212\uFE58\uFE63\uFF0D]/g, '-');
      // Replace non-breaking spaces
      ref = ref.replace(/\u00A0/g, ' ');
      return ref.trim();
    }

    function adjustUsernameCase(username, mode) {
      switch (mode) {
        case "lower": return username.toLowerCase();
        case "upper": return username.toUpperCase();
        default: return username; // as entered
      }
    }

    function generatePassword(username, referenceNumber) {
      const refNorm = normalizeReference(referenceNumber);

      // MD5 from ASCII representation
      const md5WordArray = CryptoJS.MD5(CryptoJS.enc.Latin1.parse(refNorm));
      const md5HexUpper = md5WordArray.toString(CryptoJS.enc.Hex).toUpperCase();

      // Concatenate
      const concatenated = username + md5HexUpper;

      // SHA-256 from UTF-8
      const sha256WordArray = CryptoJS.SHA256(concatenated);
      const sha256Hex = sha256WordArray.toString(CryptoJS.enc.Hex);

      return { md5HexUpper, concatenated, sha256Hex };
    }

    document.getElementById("generateBtn").addEventListener("click", () => {
      let username = document.getElementById("username").value.trim();
      const usernameCase = document.getElementById("usernameCase").value;
      const reference = document.getElementById("reference").value.trim();

      if (!username || !reference) {
        alert("Please enter both username and reference number.");
        return;
      }

      username = adjustUsernameCase(username, usernameCase);
      const { sha256Hex } = generatePassword(username, reference);

      document.getElementById("passwordResult").textContent = sha256Hex;
      document.getElementById("resultSection").classList.remove("d-none");
    });

    document.getElementById("copyBtn").addEventListener("click", () => {
      const text = document.getElementById("passwordResult").textContent;
      navigator.clipboard.writeText(text).then(() => {
        alert("Password copied to clipboard!");
      });
    });
  </script>
</body>
</html>






